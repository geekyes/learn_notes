
## 今日星星点点
> 这在写一个特别简单的裸机程序，但是好多东西我还是没搞明白，看来的好好的整理下，
下面初次整理。

### 星期一
* 照着 stm32 标准固件库写了自己需要的驱动，基本套路就是使用如 nxp 或是 stm32 大
统一的 hal 库的形式，中断函数使用初始化一个回调函数，**感觉说这些没得用，**

### 更正记录套路
> 在知乎看到一位大神使用 github 的 issue 来记录自己的 idea ，感觉这样的做法太对
了，我自己现在使用“有道云笔记”的星星点点来记录自己的一些零星 idea，希望自己坚持
下去，慢慢细化 2018 年自己想实现的一些目标，并实现。

### 为什么有这样的想法
* 自己从小就懒，这也是为懒准备的，或是少做无用功。

## 为什么要去造轮子
* 为了更好的去理解，去锻炼自己的抽象能力。

## 想法的背景
* 自己写了一个特别简单的**裸机程序**,意识到了一个问题，虽然我自己这个程序简单，但是
要是换一款单片机，基本都要每个文件都要重新去修改，工作中是使用的 stm32f0x 系列，
但是自己日常耍的是 stm32f10x 系列的，我在下班后想直接在 f10x 上面跑，但是发现需
要改大量的东西，这个时候特别打击我这种新手，一个字，**懒**。

## 怎么办？
* 自己读书读的少，但是有看过一些零星的文章，就是创建一个中间层，想 linux 的驱动
框架，不管是什么目的，自己搞一个属于的自己的裸机驱动框架，应该是可以实现的，其实
还是有目的，就是可以练习自己的打码能力，所以还是有不少的好处。自己不想去看别人是
怎么实现的，只想自己从现有的认知基础上去做。这么做也是有别人的理论做基础的，就是
知乎 phodal 大大的[phodal 专栏](https://zhuanlan.zhihu.com/phodal)，有一篇文章有
讲，一个框架是经历了什么过程才成为了框架。基本的路径就是：根据业务实现并可以运行
--> 反复重构（记不太清楚）--> 框架。

## 目前的自己想实现的功能
* 软件分层（自上而下）： app --> drivers --> library or register(bsp) ，我要去做
的就是自己造一个适合自己使用的 drivers ，即驱动层。
* 这样分层的目的：**让驱动层 (drivers) 给应用层 (app) 提供同意的 API**，这个我主要需
要做的事儿，这里需要自己动脑子，去**抽象出单片机外设的公共属性**，还有一个难点就是多
**模块间的交互**。
* 使用 python 控制与单片机相关的硬件选择， python 需要完成单片机：
    * **型号的选择、工程文件生成（主要是管理怎么生成 bin or hex 烧录文件）**；
    * **生成 bsp 的相关函数框架，只需要自己向里面填写外设操作的代码**；

## 我想要的怎样的工程
* 命名：
    * 代码，文件： 类 linux ，即使用下划线分隔，全小写的形式。
    * 形式： 模块名 + 下划线 + 具体的名字，这样用有两个好处，第一是当你在有自动
补全的 ide 的时候，可以在输入模块名后就可以弹出所有与这个模块的东西，这样免得自己
去通过别的方法去记或是找，麻烦呀。第二个是如果你的这个名字是全局可见，可以使用这
这种形式去避免命名冲突，也可以减轻因为英语不好的压力。
* 版本管理：使用 git + github or gitee 的方式，并且使用 git 的分支来开发，主要是
去学习这种可以复盘的开发流。
* 工程的完整性：
    * 编写外设抽象文档；
    * 每个模块都有完整的单元测试 (unit test) ；
    * 不断修改工程目录管理，比如 unit test 是放到 app 层，还是在 drivers 里面为
每个不同的模块单独建立 test 文件夹。
* 其他：每一次的修改都是有理由的，比如需要把 drv 改成 drivers ，必须要写写明背景
即这样改的好处。

